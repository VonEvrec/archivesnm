<!DOCTYPE html>
<html lang="fr">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Dana N'kassa</title>
    <meta name="color-scheme" content="dark light" />
    <meta http-equiv="Content-Security-Policy" content="default-src 'self'; img-src 'self' data: blob:; media-src 'self' blob:; style-src 'self' 'unsafe-inline'; font-src 'self'; script-src 'self' 'unsafe-inline'; connect-src 'self' blob:;" />

    <style>
      :root {
        --bg-color: #0a0a0a;
        --text-color: #ffffff;
        --muted-color: #8e8e93;
        --line-color: rgba(255,255,255,0.15);
        --card-border: rgba(255,255,255,0.08);
        --focus-ring: rgba(255,255,255,0.35);
        --accent: #ffffff;
        --radius: 16px;
        --shadow-soft: 0 6px 30px rgba(0,0,0,0.35);
        --blur-strength: 24px;
        --max-w: 980px;
      }

      @media (prefers-color-scheme: light) {
        :root {
          --bg-color: #ffffff;
          --text-color: #0a0a0a;
          --muted-color: #6b6b6f;
          --line-color: rgba(0,0,0,0.12);
          --card-border: rgba(0,0,0,0.08);
          --focus-ring: rgba(0,0,0,0.35);
          --accent: #0a0a0a;
        }
      }

      html, body { height: 100%; }
      body {
        margin: 0;
        background: var(--bg-color);
        color: var(--text-color);
        font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji", "Segoe UI Emoji";
        line-height: 1.45;
        letter-spacing: -0.01em;
        overflow-x: hidden;
        -webkit-font-smoothing: antialiased;
        -moz-osx-font-smoothing: grayscale;
      }

      /* Entry animation */
      @keyframes fadeSlideUp {
        0% { opacity: 0; transform: translateY(20px); }
        100% { opacity: 1; transform: translateY(0); }
      }
      .fade-in {
        opacity: 0;
        animation: fadeSlideUp 1s ease-out forwards;
      }
      .fade-in-delay {
        opacity: 0;
        animation: fadeSlideUp 1.2s ease-out forwards;
        animation-delay: 0.3s;
      }

      /* Background visualizer */
      .visualizer-wrap {
        position: fixed; inset: 0; z-index: -2; pointer-events: none; overflow: hidden;
      }
      canvas#gl {
        position: absolute; inset: 0; width: 100%; height: 100%; display: block;
        filter: blur(var(--blur-strength)) saturate(120%);
        opacity: 0; transition: opacity 600ms cubic-bezier(0.16, 1, 0.3, 1);
      }
      .visualizer-gradient {
        position: absolute; inset: -15vh;
        background: radial-gradient(120vh 120vh at 50% 50%,
          rgba(255,0,128,0.08), rgba(0,128,255,0.08),
          rgba(0,255,128,0.04), transparent 65%);
        filter: blur(calc(var(--blur-strength) * 1.25));
        opacity: 0.6; mix-blend-mode: screen;
        animation: drift 40s linear infinite;
      }
      @keyframes drift {
        0% { transform: translate3d(0,0,0) scale(1); }
        50% { transform: translate3d(1.5rem,-1rem,0) scale(1.03); }
        100% { transform: translate3d(0,0,0) scale(1); }
      }

      /* Header */
      .header {
        position: relative; z-index: 10;
        padding: 42px 24px 24px;
        display: flex; justify-content: space-between; align-items: center;
        max-width: var(--max-w); margin: 0 auto;
      }
      .brand { font-weight: 700; font-size: clamp(1.4rem, 2vw, 1.8rem); letter-spacing: 0.06em; text-transform: uppercase; }
      .contact { font-size: 0.9rem; color: var(--muted-color); cursor: pointer; position: relative; }

      /* Main */
      .main { position: relative; z-index: 5; max-width: var(--max-w); margin: 0 auto; padding: 8px 24px 60px; }
      .intro { color: var(--muted-color); margin-bottom: 18px; font-size: 0.95rem; }

      /* List */
      .list { display: grid; gap: 16px; }
      .item { border: 1px solid var(--card-border); border-radius: 16px; backdrop-filter: blur(12px) saturate(120%); background: rgba(255,255,255,0.02); box-shadow: var(--shadow-soft); overflow: hidden; transition: transform 300ms; }
      .item:hover { transform: translateY(-1px); border-color: rgba(255,255,255,0.15); }
      .row { display: flex; align-items: center; gap: 20px; padding: 16px; }
      .track { min-width: 120px; font-size: 0.9rem; color: var(--muted-color); cursor: pointer; }

      /* Player */
      .player { padding: 14px 16px 18px; border-top: 1px solid var(--line-color); display: grid; grid-template-columns: auto 1fr auto; align-items: center; gap: 16px; max-height: 0; opacity: 0; transform: translateY(-6px); transition: all 420ms; }
      .player.open { max-height: 220px; opacity: 1; transform: translateY(0); }

      .btn { width: 40px; height: 40px; border-radius: 50%; border: 1px solid var(--line-color); background: transparent; display: grid; place-items: center; color: var(--text-color); cursor: pointer; }
      .icons { position: relative; width: 14px; height: 14px; }
      .icon-play, .icon-pause { position: absolute; inset: 0; font-size: 14px; line-height: 14px; transition: opacity 140ms ease; }
      .icon-play { opacity: 1; } .icon-pause { opacity: 0; }
      .btn.playing .icon-play { opacity: 0; } .btn.playing .icon-pause { opacity: 1; }

      .controls { display: grid; gap: 10px; }
      .bar { position: relative; width: 100%; height: 2px; background: var(--line-color); cursor: pointer; }
      .bar > .fill { position: absolute; left: 0; top: 0; height: 100%; width: 0%; background: rgba(255,255,255,0.65); }

      .time { display: flex; justify-content: space-between; font-size: 0.85rem; color: var(--muted-color); }
      .loop { width: 32px; height: 32px; border-radius: 50%; border: 1px solid var(--line-color); background: transparent; color: var(--muted-color); cursor: pointer; }
      .loop.active { color: var(--text-color); background: rgba(255,255,255,0.06); border-color: var(--focus-ring); }

      footer { position: relative; z-index: 5; max-width: var(--max-w); margin: 0 auto; padding: 32px 24px 50px; font-size: 0.9rem; color: var(--muted-color); border-top: 1px solid var(--line-color); }
    </style>
  </head>
  <body>
    <div class="visualizer-wrap" aria-hidden="true">
      <canvas id="gl"></canvas>
      <div class="visualizer-gradient"></div>
    </div>

    <header class="header fade-in">
      <div class
        <div class="main-content">
      <div class="music-list">

        <div class="music-item">
          <div class="music-header">
            <div class="track-name toggle" data-audio="NM-205.mp3">NM-205</div>
          </div>
          <div class="content">
            <div class="audio-player">
              <button class="play-button">
                <span class="play-icon">▶</span>
                <span class="pause-icon">◌</span>
              </button>
              <div class="audio-controls">
                <div class="progress-container">
                  <div class="progress-bar"></div>
                </div>
                <div class="time-display">
                  <span class="current-time">0:00</span>
                  <span class="total-time">0:00</span>
                </div>
              </div>
              
              <button class="loop-button">⟲</button>
              <audio preload="none" crossorigin="anonymous"></audio>
            </div>
          </div>
        </div>

        <div class="music-item">
          <div class="music-header">
            <div class="track-name toggle" data-audio="NM-209.mp3">NM-209</div>
          </div>
          <div class="content">
            <div class="audio-player">
              <button class="play-button">
                <span class="play-icon">▶</span>
                <span class="pause-icon">◌</span>
              </button>
              <div class="audio-controls">
                <div class="progress-container">
                  <div class="progress-bar"></div>
                </div>
                <div class="time-display">
                  <span class="current-time">0:00</span>
                  <span class="total-time">0:00</span>
                </div>
              </div>
              
              <button class="loop-button">⟲</button>
              <audio preload="none" crossorigin="anonymous"></audio>
            </div>
          </div>
        </div>

        <div class="music-item">
          <div class="music-header">
            <div class="track-name toggle" data-audio="NM-208.mp3">NM-208</div>
          </div>
          <div class="content">
            <div class="audio-player">
              <button class="play-button">
                <span class="play-icon">▶</span>
                <span class="pause-icon">◌</span>
              </button>
              <div class="audio-controls">
                <div class="progress-container">
                  <div class="progress-bar"></div>
                </div>
                <div class="time-display">
                  <span class="current-time">0:00</span>
                  <span class="total-time">0:00</span>
                </div>
              </div>
              
              <button class="loop-button">⟲</button>
              <audio preload="none" crossorigin="anonymous"></audio>
            </div>
          </div>
        </div>

        <div class="music-item">
          <div class="music-header">
            <div class="track-name toggle" data-audio="NM-197.mp3">NM-197</div>
          </div>
          <div class="content">
            <div class="audio-player">
              <button class="play-button">
                <span class="play-icon">▶</span>
                <span class="pause-icon">◌</span>
              </button>
              <div class="audio-controls">
                <div class="progress-container">
                  <div class="progress-bar"></div>
                </div>
                <div class="time-display">
                  <span class="current-time">0:00</span>
                  <span class="total-time">0:00</span>
                </div>
              </div>
              
              <button class="loop-button">⟲</button>
              <audio preload="none" crossorigin="anonymous"></audio>
            </div>
          </div>
        </div>

        <div class="music-item">
          <div class="music-header">
            <div class="track-name toggle" data-audio="NM-153.mp3">NM-153</div>
          </div>
          <div class="content">
            <div class="audio-player">
              <button class="play-button">
                <span class="play-icon">▶</span>
                <span class="pause-icon">◌</span>
              </button>
              <div class="audio-controls">
                <div class="progress-container">
                  <div class="progress-bar"></div>
                </div>
                <div class="time-display">
                  <span class="current-time">0:00</span>
                  <span class="total-time">0:00</span>
                </div>
              </div>
              
              <button class="loop-button">⟲</button>
              <audio preload="none" crossorigin="anonymous"></audio>
            </div>
          </div>
        </div>

        <div class="music-item">
          <div class="music-header">
            <div class="track-name toggle" data-audio="NM-155.mp3">NM-155</div>
          </div>
          <div class="content">
            <div class="audio-player">
              <button class="play-button">
                <span class="play-icon">▶</span>
                <span class="pause-icon">◌</span>
              </button>
              <div class="audio-controls">
                <div class="progress-container">
                  <div class="progress-bar"></div>
                </div>
                <div class="time-display">
                  <span class="current-time">0:00</span>
                  <span class="total-time">0:00</span>
                </div>
              </div>
              
              <button class="loop-button">⟲</button>
              <audio preload="none" crossorigin="anonymous"></audio>
            </div>
          </div>
        </div>

        <div class="music-item">
          <div class="music-header">
            <div class="track-name toggle" data-audio="NM-157.mp3">NM-157</div>
          </div>
          <div class="content">
            <div class="audio-player">
              <button class="play-button">
                <span class="play-icon">▶</span>
                <span class="pause-icon">◌</span>
              </button>
              <div class="audio-controls">
                <div class="progress-container">
                  <div class="progress-bar"></div>
                </div>
                <div class="time-display">
                  <span class="current-time">0:00</span>
                  <span class="total-time">0:00</span>
                </div>
              </div>
              
              <button class="loop-button">⟲</button>
              <audio preload="none" crossorigin="anonymous"></audio>
            </div>
          </div>
        </div>

        <div class="music-item">
          <div class="music-header">
            <div class="track-name toggle" data-audio="NM-156.mp3">NM-156</div>
          </div>
          <div class="content">
            <div class="audio-player">
              <button class="play-button">
                <span class="play-icon">▶</span>
                <span class="pause-icon">◌</span>
              </button>
              <div class="audio-controls">
                <div class="progress-container">
                  <div class="progress-bar"></div>
                </div>
                <div class="time-display">
                  <span class="current-time">0:00</span>
                  <span class="total-time">0:00</span>
                </div>
              </div>
              
              <button class="loop-button">⟲</button>
              <audio preload="none" crossorigin="anonymous"></audio>
            </div>
          </div>
        </div>

        <div class="music-item">
          <div class="music-header">
            <div class="track-name toggle" data-audio="NM-158.mp3">NM-158</div>
          </div>
          <div class="content">
            <div class="audio-player">
              <button class="play-button">
                <span class="play-icon">▶</span>
                <span class="pause-icon">◌</span>
              </button>
              <div class="audio-controls">
                <div class="progress-container">
                  <div class="progress-bar"></div>
                </div>
                <div class="time-display">
                  <span class="current-time">0:00</span>
                  <span class="total-time">0:00</span>
                </div>
              </div>
              
              <button class="loop-button">⟲</button>
              <audio preload="none" crossorigin="anonymous"></audio>
            </div>
          </div>
        </div>

        <div class="music-item">
          <div class="music-header">
            <div class="track-name toggle" data-audio="NM-120.mp3">NM-120</div>
          </div>
          <div class="content">
            <div class="audio-player">
              <button class="play-button">
                <span class="play-icon">▶</span>
                <span class="pause-icon">◌</span>
              </button>
              <div class="audio-controls">
                <div class="progress-container">
                  <div class="progress-bar"></div>
                </div>
                <div class="time-display">
                  <span class="current-time">0:00</span>
                  <span class="total-time">0:00</span>
                </div>
              </div>
              
              <button class="loop-button">⟲</button>
              <audio preload="none" crossorigin="anonymous"></audio>
            </div>
          </div>
        </div>

        <div class="music-item">
          <div class="music-header">
            <div class="track-name toggle" data-audio="NM-092.mp3">NM-092</div>
          </div>
          <div class="content">
            <div class="audio-player">
              <button class="play-button">
                <span class="play-icon">▶</span>
                <span class="pause-icon">◌</span>
              </button>
              <div class="audio-controls">
                <div class="progress-container">
                  <div class="progress-bar"></div>
                </div>
                <div class="time-display">
                  <span class="current-time">0:00</span>
                  <span class="total-time">0:00</span>
                </div>
              </div>
              
              <button class="loop-button">⟲</button>
              <audio preload="none" crossorigin="anonymous"></audio>
            </div>
          </div>
        </div>

        <div class="music-item">
          <div class="music-header">
            <div class="track-name toggle" data-audio="NM-087.mp3">NM-087</div>
          </div>
          <div class="content">
            <div class="audio-player">
              <button class="play-button">
                <span class="play-icon">▶</span>
                <span class="pause-icon">◌</span>
              </button>
              <div class="audio-controls">
                <div class="progress-container">
                  <div class="progress-bar"></div>
                </div>
                <div class="time-display">
                  <span class="current-time">0:00</span>
                  <span class="total-time">0:00</span>
                </div>
              </div>
              
              <button class="loop-button">⟲</button>
              <audio preload="none" crossorigin="anonymous"></audio>
            </div>
          </div>
        </div>

        <div class="music-item">
          <div class="music-header">
            <div class="track-name toggle" data-audio="NM-046.mp3">NM-046</div>
          </div>
          <div class="content">
            <div class="audio-player">
              <button class="play-button">
                <span class="play-icon">▶</span>
                <span class="pause-icon">◌</span>
              </button>
              <div class="audio-controls">
                <div class="progress-container">
                  <div class="progress-bar"></div>
                </div>
                <div class="time-display">
                  <span class="current-time">0:00</span>
                  <span class="total-time">0:00</span>
                </div>
              </div>
              
              <button class="loop-button">⟲</button>
              <audio preload="none" crossorigin="anonymous"></audio>
            </div>
          </div>
        </div>

        <div class="music-item">
          <div class="music-header">
            <div class="track-name toggle" data-audio="NM-027.mp3">NM-027</div>
          </div>
          <div class="content">
            <div class="audio-player">
              <button class="play-button">
                <span class="play-icon">▶</span>
                <span class="pause-icon">◌</span>
              </button>
              <div class="audio-controls">
                <div class="progress-container">
                  <div class="progress-bar"></div>
                </div>
                <div class="time-display">
                  <span class="current-time">0:00</span>
                  <span class="total-time">0:00</span>
                </div>
              </div>
              
              <button class="loop-button">⟲</button>
              <audio preload="none" crossorigin="anonymous"></audio>
            </div>
          </div>
        </div>

        <div class="music-item">
          <div class="music-header">
            <div class="track-name toggle" data-audio="NM-044.mp3">NM-044</div>
          </div>
          <div class="content">
            <div class="audio-player">
              <button class="play-button">
                <span class="play-icon">▶</span>
                <span class="pause-icon">◌</span>
              </button>
              <div class="audio-controls">
                <div class="progress-container">
                  <div class="progress-bar"></div>
                </div>
                <div class="time-display">
                  <span class="current-time">0:00</span>
                  <span class="total-time">0:00</span>
                </div>
              </div>
              
              <button class="loop-button">⟲</button>
              <audio preload="none" crossorigin="anonymous"></audio>
            </div>
          </div>
        </div>

        <div class="music-item">
          <div class="music-header">
            <div class="track-name toggle" data-audio="NM-042.mp3">NM-042</div>
          </div>
          <div class="content">
            <div class="audio-player">
              <button class="play-button">
                <span class="play-icon">▶</span>
                <span class="pause-icon">◌</span>
              </button>
              <div class="audio-controls">
                <div class="progress-container">
                  <div class="progress-bar"></div>
                </div>
                <div class="time-display">
                  <span class="current-time">0:00</span>
                  <span class="total-time">0:00</span>
                </div>
              </div>
              
              <button class="loop-button">⟲</button>
              <audio preload="none" crossorigin="anonymous"></audio>
            </div>
          </div>
        </div>

        <div class="music-item">
          <div class="music-header">
            <div class="track-name toggle" data-audio="NM-064.mp3">NM-064</div>
          </div>
          <div class="content">
            <div class="audio-player">
              <button class="play-button">
                <span class="play-icon">▶</span>
                <span class="pause-icon">◌</span>
              </button>
              <div class="audio-controls">
                <div class="progress-container">
                  <div class="progress-bar"></div>
                </div>
                <div class="time-display">
                  <span class="current-time">0:00</span>
                  <span class="total-time">0:00</span>
                </div>
              </div>
              
              <button class="loop-button">⟲</button>
              <audio preload="none" crossorigin="anonymous"></audio>
            </div>
          </div>
        </div>

     <div class="music-item">
          <div class="music-header">
            <div class="track-name toggle" data-audio="NM-084.mp3">NM-084</div>
          </div>
          <div class="content">
            <div class="audio-player">
              <button class="play-button">
                <span class="play-icon">▶</span>
                <span class="pause-icon">◌</span>
              </button>
              <div class="audio-controls">
                <div class="progress-container">
                  <div class="progress-bar"></div>
                </div>
                <div class="time-display">
                  <span class="current-time">0:00</span>
                  <span class="total-time">0:00</span>
                </div>
              </div>
              
              <button class="loop-button">⟲</button>
              <audio preload="none" crossorigin="anonymous"></audio>
            </div>
          </div>
        </div>

      <div class="music-item">
          <div class="music-header">
            <div class="track-name toggle" data-audio="NM-079.mp3">NM-079</div>
          </div>
          <div class="content">
            <div class="audio-player">
              <button class="play-button">
                <span class="play-icon">▶</span>
                <span class="pause-icon">◌</span>
              </button>
              <div class="audio-controls">
                <div class="progress-container">
                  <div class="progress-bar"></div>
                </div>
                <div class="time-display">
                  <span class="current-time">0:00</span>
                  <span class="total-time">0:00</span>
                </div>
              </div>
              
              <button class="loop-button">⟲</button>
              <audio preload="none" crossorigin="anonymous"></audio>
            </div>
          </div>
        </div>

      <div class="music-item">
          <div class="music-header">
            <div class="track-name toggle" data-audio="NM-073.mp3">NM-073</div>
          </div>
          <div class="content">
            <div class="audio-player">
              <button class="play-button">
                <span class="play-icon">▶</span>
                <span class="pause-icon">◌</span>
              </button>
              <div class="audio-controls">
                <div class="progress-container">
                  <div class="progress-bar"></div>
                </div>
                <div class="time-display">
                  <span class="current-time">0:00</span>
                  <span class="total-time">0:00</span>
                </div>
              </div>
              
              <button class="loop-button">⟲</button>
              <audio preload="none" crossorigin="anonymous"></audio>
            </div>
          </div>
        </div>

      <div class="music-item">
          <div class="music-header">
            <div class="track-name toggle" data-audio="NM-072.mp3">NM-072</div>
          </div>
          <div class="content">
            <div class="audio-player">
              <button class="play-button">
                <span class="play-icon">▶</span>
                <span class="pause-icon">◌</span>
              </button>
              <div class="audio-controls">
                <div class="progress-container">
                  <div class="progress-bar"></div>
                </div>
                <div class="time-display">
                  <span class="current-time">0:00</span>
                  <span class="total-time">0:00</span>
                </div>
              </div>
              
              <button class="loop-button">⟲</button>
              <audio preload="none" crossorigin="anonymous"></audio>
            </div>
          </div>
        </div>

      <div class="music-item">
          <div class="music-header">
            <div class="track-name toggle" data-audio="NM-020.mp3">NM-020</div>
          </div>
          <div class="content">
            <div class="audio-player">
              <button class="play-button">
                <span class="play-icon">▶</span>
                <span class="pause-icon">◌</span>
              </button>
              <div class="audio-controls">
                <div class="progress-container">
                  <div class="progress-bar"></div>
                </div>
                <div class="time-display">
                  <span class="current-time">0:00</span>
                  <span class="total-time">0:00</span>
                </div>
              </div>
              
              <button class="loop-button">⟲</button>
              <audio preload="none" crossorigin="anonymous"></audio>
            </div>
          </div>
        </div>

      <div class="music-item">
          <div class="music-header">
            <div class="track-name toggle" data-audio="NM-037.mp3">NM-037</div>
          </div>
          <div class="content">
            <div class="audio-player">
              <button class="play-button">
                <span class="play-icon">▶</span>
                <span class="pause-icon">◌</span>
              </button>
              <div class="audio-controls">
                <div class="progress-container">
                  <div class="progress-bar"></div>
                </div>
                <div class="time-display">
                  <span class="current-time">0:00</span>
                  <span class="total-time">0:00</span>
                </div>
              </div>
              
              <button class="loop-button">⟲</button>
              <audio preload="none" crossorigin="anonymous"></audio>
            </div>
          </div>
        </div>

      </div>
    </div>

    <footer>© Dana N'kassa</footer>

    <script>
      

      // Sécurité renforcée
      const securityMeasures = {
        preventRightClick: () => {
          document.addEventListener('contextmenu', e => {
            if (e.target.tagName === 'AUDIO' || e.target.closest('.audio-player')) {
              e.preventDefault();
              return false;
            }
          });
        },
        
        preventKeyboardShortcuts: () => {
          document.addEventListener('keydown', (e) => {
            // Empêcher Ctrl+S, Ctrl+Shift+I, F12, etc.
            if ((e.ctrlKey || e.metaKey) && (
              e.key === 's' || e.key === 'S' ||
              e.key === 'u' || e.key === 'U' ||
              (e.shiftKey && (e.key === 'I' || e.key === 'i'))
            )) {
              e.preventDefault();
              return false;
            }
            if (e.key === 'F12') {
              e.preventDefault();
              return false;
            }
          });
        },
        
        obfuscateAudioSrc: (originalSrc) => {
          // Ajouter des paramètres aléatoires pour compliquer l'accès direct
          const timestamp = Date.now();
          const random = Math.random().toString(36).substring(7);
          return `${originalSrc}?t=${timestamp}&r=${random}`;
        }
      };

      // Initialiser les mesures de sécurité
      securityMeasures.preventRightClick();
      securityMeasures.preventKeyboardShortcuts();

      

      function resetAudioPlayer(content) {
        const audio = content.querySelector('audio');
        const playButton = content.querySelector('.play-button');
        const progressBar = content.querySelector('.progress-bar');
        const currentTimeSpan = content.querySelector('.current-time');
        const totalTimeSpan = content.querySelector('.total-time');
        const loopButton = content.querySelector('.loop-button');
        
        // Arrêter et réinitialiser l'audio
        if (audio) {
          audio.pause();
          audio.currentTime = 0;
          audio.src = '';
        }
        
        // Réinitialiser l'interface
        playButton.classList.remove('playing');
        progressBar.style.width = '0%';
        currentTimeSpan.textContent = '0:00';
        totalTimeSpan.textContent = '0:00';
        loopButton.classList.remove('active');
        
        
      }

      document.querySelectorAll('.toggle').forEach(link => {
        link.addEventListener('click', function (e) {
          e.preventDefault();
          const parent = this.closest('.music-item');
          const content = parent.querySelector('.content');
          const isOpen = content.classList.contains('open');

          // Fermer tous les autres lecteurs et les réinitialiser
          document.querySelectorAll('.content.open').forEach(otherContent => {
            if (otherContent !== content) {
              otherContent.classList.remove('open');
              resetAudioPlayer(otherContent);
            }
          });

          if (!isOpen) {
            const audioSrc = this.dataset.audio;
            const audio = content.querySelector('audio');
            const playButton = content.querySelector('.play-button');
            const progressBar = content.querySelector('.progress-bar');
            const progressContainer = content.querySelector('.progress-container');
            const currentTimeSpan = content.querySelector('.current-time');
            const totalTimeSpan = content.querySelector('.total-time');
            const loopButton = content.querySelector('.loop-button');
            

            // Réinitialiser avant de configurer
            resetAudioPlayer(content);

            // Configurer l'audio avec sécurité renforcée
            const secureAudioSrc = securityMeasures.obfuscateAudioSrc(audioSrc);
            audio.src = secureAudioSrc;
            
            // Sécurité supplémentaire
            audio.addEventListener('contextmenu', e => e.preventDefault());
            audio.controlsList = 'nodownload noremoteplayback nofullscreen';
            audio.disablePictureInPicture = true;
            audio.preload = 'none';

            // Auto-lecture au clic sur le titre
            audio.addEventListener('canplaythrough', () => {
  // Jouer automatiquement dès que c'est possible
  const playPromise = audio.play();
  if (playPromise !== undefined) {
    playPromise.then(() => {
      playButton.classList.add('playing');
      currentlyPlaying = audio;
      
      
    }).catch(e => {
      console.log('Autoplay nécessite une interaction utilisateur');
      // Forcer la lecture au premier clic
      playButton.click();
    });
  }
});

// Forcer le chargement et la lecture
audio.load();

            // Gestion du bouton play/pause
            let isProcessing = false; // Prévient les double-clics

playButton.addEventListener('click', async (e) => {
  e.preventDefault();
  e.stopPropagation();
  
  if (isProcessing) return;
  isProcessing = true;
  
  try {
    if (audio.paused) {
      // Arrêter tout autre audio en cours
      if (currentlyPlaying && currentlyPlaying !== audio) {
        currentlyPlaying.pause();
        document.querySelectorAll('.play-button.playing').forEach(btn => {
          btn.classList.remove('playing');
        });
      }
      
      // Mise à jour immédiate de l'UI
      playButton.classList.add('playing');
      
      await audio.play();
      currentlyPlaying = audio;
    } else {
      // Mise à jour immédiate de l'UI
      playButton.classList.remove('playing');
      
      audio.pause();
      currentlyPlaying = null;
    }
  } catch (error) {
    console.error('Erreur de lecture:', error);
    playButton.classList.remove('playing');
    currentlyPlaying = null;
  }
  
  
  setTimeout(() => {
    isProcessing = false;
  }, 100);
});


playButton.addEventListener('touchstart', (e) => {
  e.preventDefault();
  playButton.style.transform = 'scale(0.95)';
}, { passive: false });

playButton.addEventListener('touchend', (e) => {
  e.preventDefault();
  playButton.style.transform = '';
}, { passive: false });

            
            let updateTimeoutId = null;

audio.addEventListener('timeupdate', () => {
  if (updateTimeoutId) return;
  
  updateTimeoutId = requestAnimationFrame(() => {
    const progress = (audio.currentTime / audio.duration) * 100;
    progressBar.style.width = progress + '%';
    currentTimeSpan.textContent = formatTime(audio.currentTime);
    updateTimeoutId = null;
  });
});


audio.addEventListener('play', () => {
  if (!playButton.classList.contains('playing')) {
    playButton.classList.add('playing');
  }
});

audio.addEventListener('pause', () => {
  if (playButton.classList.contains('playing')) {
    playButton.classList.remove('playing');
  }
});


audio.addEventListener('ended', () => {
  if (!audio.loop) {
    playButton.classList.remove('playing');
    currentlyPlaying = null;
  }
});

           
            audio.addEventListener('error', (e) => {
              console.error('Erreur de lecture audio:', e);
              playButton.classList.remove('playing');
              
              currentlyPlaying = null;
            });

            content.classList.add('open');


setTimeout(() => {
  if (audio.readyState >= 2) { // HAVE_CURRENT_DATA
    audio.play().then(() => {
      playButton.classList.add('playing');
      currentlyPlaying = audio;
      
      
    }).catch(e => console.log('Lecture manuelle requise'));
  }
}, 100);
          } else {
            
            content.classList.remove('open');
            resetAudioPlayer(content);
            if (currentlyPlaying && currentlyPlaying === content.querySelector('audio')) {
              currentlyPlaying = null;
            }
          }
        });
      });

      function formatTime(seconds) {
        if (isNaN(seconds)) return '0:00';
        const minutes = Math.floor(seconds / 60);
        const remainingSeconds = Math.floor(seconds % 60);
        return minutes + ':' + (remainingSeconds < 10 ? '0' : '') + remainingSeconds;
      }

     
      if (typeof DevTools !== 'undefined') {
        DevTools.close();
      }

     
      document.addEventListener('selectstart', (e) => {
        if (e.target.closest('.audio-player')) {
          e.preventDefault();
        }
      });

      
      document.addEventListener('dragstart', (e) => {
        if (e.target.closest('.audio-player')) {
          e.preventDefault();
        }
      });

      
      const originalLog = console.log;
      console.log = function(...args) {
        const argsStr = args.join(' ');
        if (!argsStr.includes('demo') && !argsStr.includes('.mp3')) {
          originalLog.apply(console, args);
        }
      };

      

      
      window.addEventListener('load', () => {
        document.querySelectorAll('audio').forEach(audio => {
          audio.addEventListener('loadstart', () => {
            
            Object.defineProperty(audio, 'src', {
              get: () => '[PROTECTED]',
              set: (value) => {
                audio.setAttribute('src', value);
              }
            });
          });
        });
      });
    </script>
  </body>
</html>
