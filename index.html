import { useState, useCallback } from "react";
import { ExpandableAudioPlayer } from "@/components/ExpandableAudioPlayer";
import { useSecurity } from "@/hooks/useSecurity";

const tracks = [
  "NM-205", "NM-209", "NM-208", "NM-197", "NM-153", "NM-155", 
  "NM-157", "NM-156", "NM-158", "NM-120", "NM-092", "NM-087",
  "NM-046", "NM-027", "NM-044", "NM-042", "NM-064", "NM-084",
  "NM-079", "NM-073", "NM-072", "NM-020", "NM-037"
];

const Index = () => {
  const [openTrackIndex, setOpenTrackIndex] = useState<number | null>(null);
  const [currentlyPlayingIndex, setCurrentlyPlayingIndex] = useState<number | null>(null);

  // Enable security measures
  useSecurity();

  const handleToggle = useCallback((index: number) => {
    setOpenTrackIndex(prev => prev === index ? null : index);
  }, []);

  const handlePlay = useCallback((index: number) => {
    setCurrentlyPlayingIndex(index);
  }, []);

  return (
    <div className="min-h-screen">
      <header className="container mx-auto px-8 py-12 flex justify-between items-start">
        <h1 className="text-3xl font-semibold tracking-tight hover:opacity-80 transition-opacity duration-300">
          𝐃𝐀𝐍𝐀 𝐍'𝐊𝐀𝐒𝐒𝐀
        </h1>
        <a 
          href="mailto:contact.danankassa@gmail.com"
          className="text-sm text-foreground/50 hover:text-foreground transition-colors duration-300 font-medium relative cursor-pointer group"
        >
          <span className="relative">
            contact.danankassa@gmail.com
            <span className="absolute bottom-0 left-0 w-full h-px bg-foreground/50 origin-left scale-x-0 transition-transform duration-300 group-hover:scale-x-100 opacity-70" />
          </span>
        </a>
      </header>

      <main className="container mx-auto px-8 pb-32">
        <div className="max-w-[940px]">
          <div className="flex flex-col gap-[18px]">
            {tracks.map((trackId, index) => (
              <ExpandableAudioPlayer
                key={trackId}
                trackId={trackId}
                audioSrc={`/demos/${encodeURIComponent(trackId)}.mp3`}
                isOpen={openTrackIndex === index}
                onToggle={() => handleToggle(index)}
                onPlay={() => handlePlay(index)}
              />
            ))}
          </div>
        </div>
      </main>

      <footer className="fixed bottom-0 left-0 right-0 py-8 text-center pointer-events-none">
        <p className="text-xs text-foreground/30 font-medium tracking-wide">
          © Dana N'Kassa
        </p>
      </footer>
    </div>
  );
};

export default Index;
